// Generated by BUCKLESCRIPT VERSION 6.0.3, PLEASE EDIT WITH CARE

import * as Matrix from "./matrix.bs.js";
import * as Tea_app from "bucklescript-tea/lib/es6/src-ocaml/tea_app.js";
import * as Tea_cmd from "bucklescript-tea/lib/es6/src-ocaml/tea_cmd.js";
import * as Tea_sub from "bucklescript-tea/lib/es6/src-ocaml/tea_sub.js";
import * as Tea_html from "bucklescript-tea/lib/es6/src-ocaml/tea_html.js";
import * as Tea_promise from "bucklescript-tea/lib/es6/src-ocaml/tea_promise.js";
import * as Caml_chrome_debugger from "bs-platform/lib/es6/caml_chrome_debugger.js";

function login(param_0) {
  return /* Login */Caml_chrome_debugger.simpleVariant("Login", [param_0]);
}

function init(param) {
  console.log("init");
  var client = Matrix.new_client(/* () */0);
  var model = /* record */Caml_chrome_debugger.record([
      "client",
      "matrix_id"
    ], [
      client,
      undefined
    ]);
  var cmd = Tea_promise.result(Matrix.login(client), login);
  return /* tuple */[
          model,
          cmd
        ];
}

function update(model, param) {
  var match = param[0];
  if (match.tag) {
    console.log(match[0]);
    return /* tuple */[
            model,
            Tea_cmd.none
          ];
  } else {
    var res = match[0];
    console.log(res);
    return /* tuple */[
            /* record */Caml_chrome_debugger.record([
                "client",
                "matrix_id"
              ], [
                model[/* client */0],
                res.user_id
              ]),
            Tea_cmd.none
          ];
  }
}

function view(model) {
  var match = model[/* matrix_id */1];
  return Tea_html.div(undefined, undefined, /* [] */0, /* :: */Caml_chrome_debugger.simpleVariant("::", [
                Tea_html.span(undefined, undefined, /* :: */Caml_chrome_debugger.simpleVariant("::", [
                        Tea_html.style("text-weight", "bold"),
                        /* [] */0
                      ]), /* :: */Caml_chrome_debugger.simpleVariant("::", [
                        Tea_html.text(match !== undefined ? match : "disconnected"),
                        /* [] */0
                      ])),
                /* [] */0
              ]));
}

function partial_arg_003(param) {
  return Tea_sub.none;
}

var partial_arg = /* record */Caml_chrome_debugger.record([
    "init",
    "update",
    "view",
    "subscriptions"
  ], [
    init,
    update,
    view,
    partial_arg_003
  ]);

function main(param, param$1) {
  return Tea_app.standardProgram(partial_arg, param, param$1);
}

export {
  login ,
  init ,
  update ,
  view ,
  main ,
  
}
/* Matrix Not a pure module */
