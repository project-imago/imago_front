// Generated by BUCKLESCRIPT VERSION 6.0.3, PLEASE EDIT WITH CARE

import * as Matrix from "./matrix.bs.js";
import * as Tea_cmd from "bucklescript-tea/lib/es6/src-ocaml/tea_cmd.js";
import * as Tea_promise from "bucklescript-tea/lib/es6/src-ocaml/tea_promise.js";
import * as Caml_chrome_debugger from "bs-platform/lib/es6/caml_chrome_debugger.js";

function login(param_0) {
  return /* Login */Caml_chrome_debugger.variant("Login", 0, [param_0]);
}

function getJoinedRooms(param_0) {
  return /* GetJoinedRooms */Caml_chrome_debugger.variant("GetJoinedRooms", 1, [param_0]);
}

var client = Matrix.new_client(/* () */0);

var model = /* record */Caml_chrome_debugger.record([
    "client",
    "matrix_id",
    "joined_rooms_ids"
  ], [
    client,
    undefined,
    0
  ]);

var cmd = Tea_promise.result(Matrix.login(client), login);

var init = /* tuple */[
  model,
  cmd
];

function update(model, param) {
  if (param.tag) {
    var match = param[0];
    if (match.tag) {
      console.log(match[0]);
      return /* tuple */[
              model,
              Tea_cmd.none
            ];
    } else {
      var res = match[0];
      console.log(res);
      var model_000 = /* client */model[/* client */0];
      var model_001 = /* matrix_id */model[/* matrix_id */1];
      var model$1 = /* record */Caml_chrome_debugger.record([
          "client",
          "matrix_id",
          "joined_rooms_ids"
        ], [
          model_000,
          model_001,
          res
        ]);
      return /* tuple */[
              model$1,
              Tea_cmd.none
            ];
    }
  } else {
    var match$1 = param[0];
    if (match$1.tag) {
      console.log(match$1[0]);
      return /* tuple */[
              model,
              Tea_cmd.none
            ];
    } else {
      var res$1 = match$1[0];
      console.log(res$1);
      var model_000$1 = /* client */model[/* client */0];
      var model_001$1 = /* matrix_id */res$1.user_id;
      var model_002 = /* joined_rooms_ids */model[/* joined_rooms_ids */2];
      var model$2 = /* record */Caml_chrome_debugger.record([
          "client",
          "matrix_id",
          "joined_rooms_ids"
        ], [
          model_000$1,
          model_001$1,
          model_002
        ]);
      var cmd = Tea_promise.result(Matrix.get_joined_rooms(model_000$1), getJoinedRooms);
      return /* tuple */[
              model$2,
              cmd
            ];
    }
  }
}

export {
  login ,
  getJoinedRooms ,
  init ,
  update ,
  
}
/* client Not a pure module */
